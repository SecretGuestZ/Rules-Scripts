# Loon 最小配置
# Date: 2024-10-10 10:49:39
# Author: https://t.me/iKeLee
# 更多的插件可以前往此处安装 https://github.com/luestr/ProxyResource/blob/main/README.md
# Modified: 2024-10-13  @surhide

[General]
ip-mode = ipv4-only
dns-server = system
sni-sniffing = true
disable-stun = false
dns-reject-mode = LoopbackIP
domain-reject-mode = DNS
udp-fallback-mode = REJECT
wifi-access-http-port = 7222
wifi-access-socks5-port = 7221
allow-wifi-access = false
interface-mode = auto
test-timeout = 5
disconnect-on-policy-change = false
switch-node-after-failure-times = 3
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url = http://cp.cloudflare.com
resource-parser = https://raw.githubusercontent.com/sub-store-org/Sub-Store/release/sub-store-parser.loon.min.js
geoip-url = https://raw.githubusercontent.com/Masaiki/GeoIP2-CN/release/Country.mmdb
ipasn-url = https://github.com/xream/geoip/releases/latest/download/ipinfo.asn.mmdb
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, e.crashlynatics.com
bypass-tun = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32

[Proxy]

[Remote Proxy]

[Remote Filter]
全球节点   = NameRegex, FilterKey = "^(?=.*(.))(?!.*((?i)群|邀请|返利|循环|官网|客服|网站|网址|获取|订阅|流量|到期|机场|下次|版本|官址|备用|过期|已用|联系|邮箱|工单|贩卖|通知|倒卖|防止|国内|地址|频道|无法|说明|使用|提示|特别|访问|支持|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel)\b|(\d{4}-\d{2}-\d{2}|\dG)))).*$"
香港节点   = NameRegex, FilterKey = "^(?=.*((?i)🇭🇰|香港|港|(\b(HK|Hong)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
台湾节点   = NameRegex, FilterKey = "^(?=.*((?i)🇹🇼|台湾|台|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
日本节点   = NameRegex, FilterKey = "^(?=.*((?i)🇯🇵|日本|(\b(JP|Japan)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
韩国节点   = NameRegex, FilterKey = "^(?=.*((?i)🇰🇷|韩国|韓|首尔|(\b(KR|Korea)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
新加坡节点 = NameRegex, FilterKey = "^(?=.*((?i)🇸🇬|新加坡|狮|(\b(SG|Singapore)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
美国节点   = NameRegex, FilterKey = "^(?=.*((?i)🇺🇸|美国|美|(\b(US|United States|America)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
加拿大节点 = NameRegex, FilterKey = "^(?=.*((?i)🇨🇦|加拿大|加|(\b(CA|Canada)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"
英国节点   = NameRegex, FilterKey = "^(?=.*((?i)🇬🇧|英国|联合王国|英格兰|不列颠|(\b(GB|UK|England|Britain)\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)\b))).*$"

[Proxy Group]
# 时延优选策略组
香港时延优选   = url-test, 香港节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
台湾时延优选   = url-test, 台湾节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
日本时延优选   = url-test, 日本节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
韩国时延优选   = url-test, 韩国节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png
新加坡时延优选 = url-test, 新加坡节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
美国时延优选   = url-test, 美国节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
加拿大时延优选 = url-test, 加拿大节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Canada.png
英国时延优选   = url-test, 英国节点, url = http://cp.cloudflare.com, interval = 600, tolerance = 50, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_Kingdom.png

# --------------------------------
# 手动策略组
全球手动 = select, 全球节点, img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Static.png
# --------------------------------
# 兜底策略故障转移
兜底切换 = fallback, 香港时延优选, 台湾时延优选, 日本时延优选, 韩国时延优选, 新加坡时延优选, 美国时延优选, 加拿大时延优选, 英国时延优选, url = http://cp.cloudflare.com, interval = 600, max-timeout = 2000, img-url = https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/fallback.png

[Rule]
# Local Rule
# Type:DOMAIN-SUFFIX,DOMAIN,DOMAIN-KEYWORD,USER-AGENT,URL-REGEX,IP-CIDR,IP-CIDR6,IP-ASN
# Strategy:DIRECT,Proxy,REJECT
# Options:no-resolve(no-resolve(only for cidr))
# IP-CIDR, 192.168.0.0/16, DIRECT
# IP-CIDR, 10.0.0.0/8, DIRECT
# IP-CIDR, 172.16.0.0/12, DIRECT
# IP-CIDR, 127.0.0.0/8, DIRECT
# 配置文件已自带远程GEOIP, cn, DIRECT规则，请勿在此添加
# 请勿修改远程CN REGION规则的排序甚至删除
FINAL, 兜底切换

[Remote Rule]
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Direct/Direct.list,             policy = DIRECT, tag = 优先直连, enabled = true
https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main/Filters/AWAvenue-Ads-Rule-Surge.list,      policy = REJECT, tag = AdBlock, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Download/Download.list,         policy = DIRECT, tag = 下载直连, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/WeChat/WeChat.list,      policy = DIRECT, tag = 微信服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/DouYin/DouYin.list,             policy = DIRECT, tag = 抖音服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Sina/Sina.list,                 policy = DIRECT, tag = 新浪服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Zhihu/Zhihu.list,               policy = DIRECT, tag = 知乎服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/DingTalk/DingTalk.list,         policy = DIRECT, tag = 钉钉服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Baidu/Baidu.list,               policy = DIRECT, tag = 百度服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/ChinaMedia/ChinaMedia.list,     policy = DIRECT, tag = 国内媒体, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Apple/Apple.list,        policy = DIRECT, tag = 苹果服务, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Bing/Bing.list,                 policy = 兜底切换, tag = MSPROXY, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Copilot/Copilot.list,           policy = 兜底切换, tag = MSPROXY, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Microsoft/Microsoft.list,       policy = DIRECT, tag = 微软直连, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Google/Google.list,             policy = 兜底切换, tag = Google, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/YouTube/YouTube.list,           policy = 兜底切换, tag = Youtube, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Telegram/Telegram.list,         policy = 兜底切换, tag = Telegram, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/OpenAI/OpenAI.list,             policy = 兜底切换, tag = ChatGPT, enabled = true
# DOMAIN-SUFFIX,perplexity.ai,🇺🇸美国节点
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GitHub/GitHub.list,             policy = 兜底切换, tag = GitHub, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Twitter/Twitter.list,           policy = 兜底切换, tag = Twitter, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Facebook/Facebook.list,         policy = 兜底切换, tag = Facebook, enabled = true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/ProxyLite/ProxyLite.list,       policy = 兜底切换, tag = Global, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Rule/LAN,                                 policy = DIRECT, tag = LAN, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Rule/CN_REGION,                           policy = DIRECT, tag = CN REGION, enabled = true

[Host]

[Rewrite]

[Script]

[Plugin]
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/LoonGallery.plugin,               policy = 兜底切换, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Block_HTTPDNS.plugin,                               enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/BlockAdvertisers.plugin,                            enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Remove_ads_by_keli.plugin,                          enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/QuickSearch.plugin,                                 enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Prevent_DNS_Leaks.plugin,         policy = 兜底切换, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Node_detection_tool.plugin,                          enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/TestFlightRegionUnlock.plugin,    policy = DIRECT,   enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/BoxJs.plugin,                     policy = 兜底切换, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Sub-Store.plugin,                 policy = 兜底切换, enabled = true
https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Loon/Plugin/Script-Hub.plugin,                policy = 兜底切换, enabled = true

[Mitm]
hostname = 
ca-p12 = 
ca-passphrase = 
skip-server-cert-verify = false
